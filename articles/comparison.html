<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comparison • JointODE</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparison">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JointODE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/technical-details.html">Technical Details</a></li>
    <li><a class="dropdown-item" href="../articles/comparison.html">Comparison</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ziyangg98/JointODE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Comparison</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ziyangg98/JointODE/blob/main/vignettes/comparison.Rmd" class="external-link"><code>vignettes/comparison.Rmd</code></a></small>
      <div class="d-none name"><code>comparison.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="simulation-setup">Simulation Setup<a class="anchor" aria-label="anchor" href="#simulation-setup"></a>
</h2>
<p>The <code>sim</code> dataset was generated using a joint ODE
framework with the following structure:</p>
<p><strong>Longitudinal Process:</strong></p>
<p>The observed biomarker measurements are: <span class="math display">v_{ij} = m_i(t_{ij}) + b_i +
\epsilon_{ij}</span></p>
<p>where the true biomarker trajectory <span class="math inline">m_i(t)</span> evolves according to:</p>
<p><span class="math display">\ddot{m}_i(t) = \beta_1 m_i(t) + \beta_2
\dot{m}_i(t) + \beta_3 + \beta_4 x_{i1} + \beta_5 x_{i2} + \beta_6
t</span></p>
<p>with <span class="math inline">b_i \sim \mathcal{N}(0,
\sigma_b^2)</span> (random intercept) and <span class="math inline">\epsilon_{ij} \sim \mathcal{N}(0, \sigma_e^2)</span>
(measurement error).</p>
<p><strong>Survival Process:</strong></p>
<p>The hazard function incorporates biomarker dynamics: <span class="math display">\lambda_i(t) = \lambda_0(t) \exp\{\alpha_1 m_i(t) +
\alpha_2 \dot{m}_i(t) + \alpha_3 \ddot{m}_i(t) + \phi_1 w_{i1} + \phi_2
w_{i2} + b_i\}</span></p>
<p>where <span class="math inline">\lambda_0(t)=8</span> is the baseline
hazard and <span class="math inline">\alpha = (\alpha_1, \alpha_2,
\alpha_3)</span> captures the association with biomarker value,
velocity, and acceleration.</p>
<pre><code><span><span class="co">#&gt; True Parameters:</span></span>
<span><span class="co">#&gt;   Hazard: α = [0.6, 1.0, -1.5], φ = [0.8, -1.2]</span></span>
<span><span class="co">#&gt;   ODE: β = [-1.0, -0.6, 0.0, -0.8, 0.5, 0.4]</span></span>
<span><span class="co">#&gt;   Variance: σ_e = 0.1, σ_b = 0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dataset: 100 subjects, 1010 observations, 77% events</span></span></code></pre>
<div class="section level3">
<h3 id="ode-dynamics">ODE Dynamics<a class="anchor" aria-label="anchor" href="#ode-dynamics"></a>
</h3>
<p><img src="comparison_files/figure-html/viz-combined-1.png" width="960"></p>
<p>The left panel shows the complete ODE dynamics for four randomly
selected subjects, illustrating how the biomarker value, velocity, and
acceleration evolve over time. The right panel demonstrates the impact
of random intercept and measurement error by comparing the true
biomarker trajectories (lines) with the observed measurements
(points).</p>
<pre><code><span><span class="co">#&gt; Variance Components:</span></span>
<span><span class="co">#&gt;   Biomarker: 0.965</span></span>
<span><span class="co">#&gt;   Velocity: 0.142</span></span>
<span><span class="co">#&gt;   Acceleration: 0.155</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pairwise Correlations:</span></span>
<span><span class="co">#&gt;   ρ(Biomarker, Velocity): 0.461</span></span>
<span><span class="co">#&gt;   ρ(Biomarker, Acceleration): -0.234</span></span>
<span><span class="co">#&gt;   ρ(Velocity, Acceleration): 0.148</span></span></code></pre>
<p>The variance hierarchy and correlation structure reflect the
fundamental properties of the ODE system. Unlike independent variables
in traditional models, these components are mechanistically linked
through differential equations, creating intrinsic dependencies that
capture the true dynamics of biomarker evolution.</p>
</div>
<div class="section level3">
<h3 id="survival-distribution">Survival Distribution<a class="anchor" aria-label="anchor" href="#survival-distribution"></a>
</h3>
<p><img src="comparison_files/figure-html/viz-survival-1.png" width="672"></p>
<p>The survival curve shows the overall event pattern in the simulated
dataset, with the shaded area representing the 95% confidence
interval.</p>
</div>
</div>
<div class="section level2">
<h2 id="model-comparison">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<p>We compare our proposed method against existing approaches:</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="26%">
<col width="28%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Model</th>
<th>Method Type</th>
<th>Data Source</th>
<th>Key Features</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>JointODE</strong></td>
<td>Proposed</td>
<td>Noisy observations</td>
<td>ODE-based; estimates m(t), ṁ(t), m̈(t)</td>
</tr>
<tr class="even">
<td><strong>JSM</strong></td>
<td>Baseline</td>
<td>Noisy observations</td>
<td>Linear mixed effects; only models m(t)</td>
</tr>
<tr class="odd">
<td><strong>Time-varying Cox (Oracle)</strong></td>
<td>Upper bound</td>
<td>True ODE values + <span class="math inline">b_i</span>
</td>
<td>MPLE benchmark with true values</td>
</tr>
</tbody>
</table>
<p>The Oracle model uses the true biomarker trajectory, derivatives, and
random effects at observed time points. While it has perfect
information, it approximates the time-varying covariates using piecewise
linear interpolation rather than modeling the continuous ODE
dynamics.</p>
<p>Based on 100 simulation replicates, we evaluate the estimation
accuracy of the association parameters <span class="math inline">(\alpha_1, \alpha_2, \alpha_3)</span> and baseline
covariate effects <span class="math inline">(\phi_1, \phi_2)</span>
using Bias, Empirical Standard Error (ESE), Average Standard Error
(ASE), and Coverage Probability (CP) of 95% confidence intervals.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="left">Model</th>
<th align="right">Bias</th>
<th align="right">ESE</th>
<th align="right">ASE</th>
<th align="right">CP (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Baseline Covariates</strong></td>
<td align="left"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">φ₁ = 0.8</td>
<td align="left">TVCox</td>
<td align="right">0.027</td>
<td align="right">0.150</td>
<td align="right">0.137</td>
<td align="right">90.9</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">JSM</td>
<td align="right">-0.064</td>
<td align="right">0.150</td>
<td align="right">0.138</td>
<td align="right">88.9</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">JointODE</td>
<td align="right">0.040</td>
<td align="right">0.137</td>
<td align="right">0.136</td>
<td align="right">94.3</td>
</tr>
<tr class="odd">
<td align="left">φ₂ = -1.2</td>
<td align="left">TVCox</td>
<td align="right">-0.072</td>
<td align="right">0.184</td>
<td align="right">0.159</td>
<td align="right">92.7</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">JSM</td>
<td align="right">0.072</td>
<td align="right">0.155</td>
<td align="right">0.155</td>
<td align="right">87.0</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">JointODE</td>
<td align="right">-0.094</td>
<td align="right">0.169</td>
<td align="right">0.155</td>
<td align="right">92.5</td>
</tr>
<tr class="even">
<td align="left"><strong>Association Parameters</strong></td>
<td align="left"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">α₁ = 0.6</td>
<td align="left">TVCox</td>
<td align="right">-0.084</td>
<td align="right">0.222</td>
<td align="right">0.220</td>
<td align="right">96.4</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">JSM</td>
<td align="right">0.276</td>
<td align="right">0.260</td>
<td align="right">0.292</td>
<td align="right">90.7</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">JointODE</td>
<td align="right">-0.222</td>
<td align="right">0.161</td>
<td align="right">0.197</td>
<td align="right">84.9</td>
</tr>
<tr class="even">
<td align="left">α₂ = 1.0</td>
<td align="left">TVCox</td>
<td align="right">0.324</td>
<td align="right">0.411</td>
<td align="right">0.413</td>
<td align="right">87.3</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">JointODE</td>
<td align="right">-0.091</td>
<td align="right">0.356</td>
<td align="right">0.341</td>
<td align="right">92.5</td>
</tr>
<tr class="even">
<td align="left">α₃ = -1.5</td>
<td align="left">TVCox</td>
<td align="right">0.181</td>
<td align="right">0.335</td>
<td align="right">0.293</td>
<td align="right">85.5</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">JointODE</td>
<td align="right">-0.111</td>
<td align="right">0.319</td>
<td align="right">0.263</td>
<td align="right">92.5</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data preparation for comparison models</span></span>
<span><span class="va">jsm_data</span> <span class="op">&lt;-</span> <span class="fu">dataPreprocess</span><span class="op">(</span></span>
<span>  long <span class="op">=</span> <span class="va">long_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  surv <span class="op">=</span> <span class="va">surv_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">id</span>, survtime <span class="op">=</span> <span class="va">time</span><span class="op">)</span>,</span>
<span>  id.col <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>  long.time.col <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  surv.time.col <span class="op">=</span> <span class="st">"survtime"</span>,</span>
<span>  surv.event.col <span class="op">=</span> <span class="st">"status"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    obstime <span class="op">=</span> <span class="va">time</span>,</span>
<span>    start <span class="op">=</span> <span class="va">start.join</span>,</span>
<span>    stop <span class="op">=</span> <span class="va">stop.join</span>,</span>
<span>    event <span class="op">=</span> <span class="va">event.join</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">#--------------------------------------------</span></span>
<span><span class="co"># Model 1: JointODE (Proposed Method)</span></span>
<span><span class="co">#--------------------------------------------</span></span>
<span><span class="va">fit_jointode</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/JointODE.html">JointODE</a></span><span class="op">(</span></span>
<span>  longitudinal_formula <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">formulas</span><span class="op">$</span><span class="va">longitudinal</span>,</span>
<span>  longitudinal_data <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">longitudinal_data</span>,</span>
<span>  survival_formula <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">formulas</span><span class="op">$</span><span class="va">survival</span>,</span>
<span>  survival_data <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">survival_data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--------------------------------------------</span></span>
<span><span class="co"># Model 2: Traditional Joint Model (JSM)</span></span>
<span><span class="co">#--------------------------------------------</span></span>
<span><span class="co"># Step 1: Longitudinal sub-model</span></span>
<span><span class="va">fit_lme</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span></span>
<span>  <span class="va">v</span> <span class="op">~</span> <span class="va">obstime</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">ID</span>,</span>
<span>  data <span class="op">=</span> <span class="va">jsm_data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Survival sub-model</span></span>
<span><span class="va">fit_cox</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">start</span>, <span class="va">stop</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">w1</span> <span class="op">+</span> <span class="va">w2</span>,</span>
<span>  data <span class="op">=</span> <span class="va">jsm_data</span>, x <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 3: Joint model</span></span>
<span><span class="va">fit_jsm</span> <span class="op">&lt;-</span> <span class="fu">jmodelTM</span><span class="op">(</span></span>
<span>  <span class="va">fit_lme</span>, <span class="va">fit_cox</span>,</span>
<span>  data <span class="op">=</span> <span class="va">jsm_data</span>,</span>
<span>  timeVarY <span class="op">=</span> <span class="st">"obstime"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--------------------------------------------</span></span>
<span><span class="co"># Model 3: Time-varying Cox (Oracle - Theoretical Benchmark)</span></span>
<span><span class="co">#--------------------------------------------</span></span>
<span><span class="va">fit_oracle</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">start</span>, <span class="va">stop</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">w1</span> <span class="op">+</span> <span class="va">w2</span> <span class="op">+</span> <span class="va">biomarker</span> <span class="op">+</span> <span class="va">velocity</span> <span class="op">+</span> <span class="va">acceleration</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">+</span> <span class="fu">cluster</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">jsm_data</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ziyang Gong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

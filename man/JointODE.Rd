% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/JointODE.R
\name{JointODE}
\alias{JointODE}
\title{Fit Joint Model for Longitudinal and Survival Data Using ODEs}
\usage{
JointODE(
  longitudinal_formula,
  longitudinal_data,
  survival_formula,
  survival_data,
  id = "id",
  time = "time",
  spline_baseline = list(degree = 3, n_knots = 5, knot_placement = "quantile",
    boundary_knots = NULL),
  spline_index = list(degree = 3, n_knots = 4, knot_placement = "quantile",
    boundary_knots = NULL),
  control = list(),
  ...
)
}
\arguments{
\item{longitudinal_formula}{Formula for the longitudinal submodel.
Left side specifies the response; right side includes time and
covariates (e.g., \code{v ~ x1}).}

\item{longitudinal_data}{Data frame containing longitudinal measurements.
Must include multiple observations per subject with columns for
subject ID, measurement times, and response values.}

\item{survival_formula}{Formula for the survival submodel.
Must use \code{Surv(time, status)} on the left side;
right side specifies baseline covariates.}

\item{survival_data}{Data frame containing survival/event data.
Must have exactly one row per subject with event time and status.}

\item{id}{Character string naming the subject ID variable.
Must exist in both datasets (default: \code{"id"}).}

\item{time}{Character string naming the time variable in
longitudinal data (default: \code{"time"}).}

\item{spline_baseline}{List of B-spline configuration for baseline hazard:
\describe{
\item{\code{degree}}{Degree of B-spline basis (default: 3)}
\item{\code{n_knots}}{Number of interior knots (default: 5)}
\item{\code{knot_placement}}{Method for knot placement: "quantile"
(based on event times) or "equal" (default: "quantile")}
\item{\code{boundary_knots}}{Boundary knots, if NULL uses event range
(default: NULL)}
}}

\item{spline_index}{List of B-spline configuration for single index model:
\describe{
\item{\code{degree}}{Degree of B-spline basis (default: 3)}
\item{\code{n_knots}}{Number of interior knots (default: 4)}
\item{\code{knot_placement}}{Method for knot placement: "quantile"
(based on index values) or "equal" (default: "quantile")}
\item{\code{boundary_knots}}{Boundary knots, if NULL uses index range
(default: NULL)}
}}

\item{control}{List of optimization control parameters:
\describe{
\item{\code{method}}{Optimization algorithm (default: "BFGS")}
\item{\code{maxit}}{Maximum iterations (default: 1000)}
\item{\code{tol}}{Convergence tolerance (default: 1e-6)}
\item{\code{verbose}}{Print progress (default: FALSE)}
}}

\item{...}{Additional arguments passed to fitting functions.}
}
\value{
Object of class \code{"JointODE"} containing:
\describe{
\item{\code{coefficients}}{Estimated model parameters including
longitudinal, survival, and association parameters}
\item{\code{logLik}}{Log-likelihood at convergence}
\item{\code{AIC}}{Akaike Information Criterion}
\item{\code{BIC}}{Bayesian Information Criterion}
\item{\code{convergence}}{Optimization convergence details}
\item{\code{fitted}}{Fitted values for both submodels}
\item{\code{residuals}}{Model residuals}
\item{\code{data}}{Original input data}
\item{\code{call}}{Matched function call}
}
}
\description{
Fits a joint model that simultaneously analyzes longitudinal biomarker
trajectories and time-to-event outcomes using ordinary differential
equations (ODEs). This approach captures complex temporal dynamics in
biomarker evolution while quantifying their association with survival
through shared parameters.
}
\details{
The joint ODE model links longitudinal and survival processes through
shared parameters. The longitudinal trajectory is modeled using ODEs
to capture non-linear dynamics, while the survival hazard incorporates
features of the trajectory (level, slope, or cumulative burden).

Model estimation uses maximum likelihood with numerical integration
over random effects via adaptive Gauss-Hermite quadrature.
}
\note{
Input data are automatically validated and processed before fitting.
For large datasets or complex ODE systems, consider adjusting control
parameters to improve convergence.
}
\examples{
\dontrun{
fit <- JointODE(
  longitudinal_formula = v ~ x1 + x2,
  longitudinal_data = sim$longitudinal_data,
  survival_formula = Surv(time, status) ~ w1 + w2,
  survival_data = sim$survival_data
)
summary(fit)
}

}
\concept{modeling}

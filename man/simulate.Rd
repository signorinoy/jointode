% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate.R
\name{simulate}
\alias{simulate}
\title{Simulate Data from a Joint Ordinary Differential Equation Model}
\usage{
simulate(
  n_subjects = 200,
  shared_sd = 0.1,
  longitudinal = list(value = -0.6, slope = -0.4, ref = 0, time = 0, covariates = c(0.8,
    -0.5, -0.5), initial = list(ref = 1, covariates = c(0.1, -0.1, 0), random_coef = 0),
    error_sd = 0.1, n_measurements = 10),
  survival = list(baseline = list(type = "weibull", shape = 1.5, scale = 8), value = 0.3,
    slope = 0.7, covariates = c(0.4, -0.6, -0.3)),
  covariates = list(x1 = list(type = "normal", mean = 0, sd = 1), x2 = list(type =
    "normal", mean = 0, sd = 1), x3 = list(type = "binary", prob = 0.7)),
  maxt = 10,
  seed = 42
)
}
\arguments{
\item{n_subjects}{Integer specifying the number of subjects to simulate
(default: 500)}

\item{shared_sd}{Positive scalar defining the standard deviation of the
shared
random effects, \eqn{\sigma_b} (default: 0.1)}

\item{longitudinal}{List specifying the longitudinal sub-model parameters:
\describe{
\item{value}{Restoring force coefficient \eqn{\kappa} in the ODE
system (default: -0.6)}
\item{slope}{Damping coefficient \eqn{\gamma} controlling velocity
feedback (default: -0.4)}
\item{ref}{Reference (equilibrium) biomarker value \eqn{m_{ref}}
(default: 0, for standardized biomarkers)}
\item{time}{Time-varying coefficient for non-autonomous systems
(default: 0, indicating autonomous dynamics)}
\item{covariates}{Vector of fixed effects \eqn{\boldsymbol{\beta}}
for covariates in the acceleration equation
(default: c(0.8, -0.5, -0.5))}
\item{initial}{List specifying initial condition parameters:
\describe{
\item{ref}{Baseline mean biomarker value \eqn{\mu_{ref}}
(default: 1.0, for standardized biomarkers)}
\item{covariates}{Vector of covariate effects
\eqn{\boldsymbol{\beta}_{init}} on initial biomarker level
(default: c(0.1, -0.1, 0.0))}
\item{random_coef}{Scaling coefficient \eqn{\xi} for random effect
influence on initial conditions (default: 0.0)}
}
}
\item{error_sd}{Standard deviation \eqn{\sigma_{\epsilon}} of the
measurement error process (default: 0.1, for standardized scale)}
\item{n_measurements}{Number of longitudinal measurements per subject
(default: 10)}
}}

\item{survival}{List specifying the survival sub-model parameters:
\describe{
\item{baseline}{List defining the Weibull baseline hazard function:
\describe{
\item{type}{Character string specifying the baseline hazard type
(currently only "weibull" is supported)}
\item{shape}{Weibull shape parameter \eqn{k > 0}
(default: 1.5)}
\item{scale}{Weibull scale parameter \eqn{\lambda > 0}
(default: 8.0)}
}
}
\item{value}{Association parameter \eqn{\alpha_1} linking current
biomarker value to hazard (default: 0.3)}
\item{slope}{Association parameter \eqn{\alpha_2} linking biomarker
velocity to hazard (default: 0.7)}
\item{covariates}{Vector of regression coefficients
\eqn{\boldsymbol{\phi}} for baseline covariates
(default: c(0.4, -0.6))}
}}

\item{covariates}{List defining the distributions of baseline covariates:
\describe{
\item{x1}{List with \code{type = "normal"}, \code{mean = 0},
\code{sd = 1} for standardized continuous covariate}
\item{x2}{List with \code{type = "normal"}, \code{mean = 0},
\code{sd = 1} for standardized continuous covariate}
\item{x3}{List with \code{type = "binary"} and \code{prob = 0.7}
for binary covariate}
}}

\item{maxt}{Positive scalar specifying the maximum follow-up time in the
study (default: 10 days)}

\item{seed}{Integer seed for random number generation to ensure
reproducibility (default: 42)}
}
\value{
A list containing three components:
\describe{
\item{\code{longitudinal_data}}{Data frame comprising longitudinal
observations with columns:
\itemize{
\item \code{id}: Subject identifier (integer)
\item \code{time}: Observation time point (numeric)
\item \code{observed}: Measured biomarker value including
measurement error, \eqn{y_{ij}}
\item \code{biomarker}: True underlying biomarker value,
\eqn{m_i(t_{ij})}
\item \code{velocity}: First derivative of the biomarker trajectory,
\eqn{\dot{m}_i(t_{ij})}
\item \code{acceleration}: Second derivative of the biomarker
trajectory, \eqn{\ddot{m}_i(t_{ij})}
\item \code{x1}, \code{x2}, \code{x3}:
Time-invariant covariates
}
}
\item{\code{survival_data}}{Data frame containing time-to-event data
with columns:
\itemize{
\item \code{id}: Subject identifier
\item \code{time}: Observed event or censoring time, \eqn{T_i}
\item \code{status}: Event indicator, \eqn{\delta_i}
(1 = event observed, 0 = censored)
\item \code{b}: Realized subject-specific random effect, \eqn{b_i}
\item \code{x1}, \code{x2}, \code{x3}:
Baseline covariate values
}
}
\item{\code{state}}{An \eqn{n \times 2} matrix containing initial states
\eqn{[m_i(0), \dot{m}_i(0)]} for each subject}
}
}
\description{
Generates synthetic longitudinal and time-to-event data under a joint
modeling
framework wherein the longitudinal biomarker trajectory is governed by a
second-order ordinary differential equation (ODE), and the survival process
is associated with the biomarker dynamics through shared random effects and
trajectory-dependent hazard functions. By default, biomarkers are generated
on a standardized scale (mean ~ 0, SD ~ 1) for better numerical stability.
}
\details{
The simulation framework implements a joint model comprising longitudinal
and survival
sub-models linked through shared random effects and trajectory-dependent
associations.

\subsection{Longitudinal Sub-model}{
The biomarker trajectory \eqn{m_i(t)} for subject \eqn{i} evolves according
to the
second-order ordinary differential equation:
\deqn{\ddot{m}_i(t) = \kappa[m_i(t) - m_{ref}] + \gamma\dot{m}_i(t) +
  \mathbf{X}_i^T\boldsymbol{\beta} + \theta t}
where:
\itemize{
\item \eqn{\kappa} represents the restoring force coefficient
\item \eqn{\gamma} denotes the damping coefficient
\item \eqn{m_{ref}} is the reference (equilibrium) value
\item \eqn{\mathbf{X}_i} contains time-invariant covariates
\item \eqn{\boldsymbol{\beta}} represents fixed effects
\item \eqn{\theta} is the time-varying coefficient
(0 for autonomous systems)
}

Initial conditions are specified as:
\itemize{
\item \eqn{m_i(0) = \mu_{ref} +
    \mathbf{X}_i^T\boldsymbol{\beta}_{init} + \xi b_i}
\item \eqn{\dot{m}_i(0) = 0} (zero initial velocity)
}

The observed longitudinal measurements incorporate additive Gaussian noise:
\deqn{y_{ij} = m_i(t_{ij}) + b_i + \epsilon_{ij}}
where \eqn{\epsilon_{ij} \sim \mathcal{N}(0, \sigma_\epsilon^2)}
represents independent measurement error.
}

\subsection{Survival Sub-model}{
The instantaneous hazard function incorporates both current biomarker value
and velocity:
\deqn{\lambda_i(t) = \lambda_0(t)\exp(\alpha_1 m_i(t) + \alpha_2\dot{m}_i(t)
 + \mathbf{W}_i^T\boldsymbol{\phi} + b_i)}
where:
\itemize{
\item \eqn{\lambda_0(t)} denotes the Weibull baseline hazard:
\eqn{\lambda_0(t) = (k/\lambda)(t/\lambda)^{k-1}}
\item \eqn{\alpha_1} quantifies the association with current biomarker
value
\item \eqn{\alpha_2} quantifies the association with biomarker velocity
\item \eqn{\mathbf{W}_i} contains baseline covariates
\item \eqn{\boldsymbol{\phi}} represents covariate effects on survival
}
}

\subsection{Random Effects Structure}{
Subject-specific random effects \eqn{b_i \sim \mathcal{N}(0, \sigma_b^2)}
induce correlation
between the longitudinal and survival processes through:
\itemize{
\item Initial biomarker level via \eqn{m_i(0)}
\item Hazard function via the frailty term
\item Longitudinal observations via additive shift
}
}
}
\examples{
# Generate a small dataset with default parameters
sim_data <- simulate(n_subjects = 50, seed = 123)

# Examine the structure of generated data
str(sim_data)

\dontrun{
# Customized simulation with modified longitudinal dynamics
sim_data <- simulate(
  n_subjects = 200,
  longitudinal = list(
    value = -2.5,      # Stronger restoring force
    slope = -4.0,      # Modified damping
    ref = -1,          # Lower equilibrium value (standardized)
    time = 0.1,        # Non-autonomous system
    covariates = c(-0.4, 0.2, 0.1),
    initial = list(
      ref = 2.5,       # Initial value (standardized)
      covariates = c(-1.0, 0.8, 0.4),
      random_coef = 1.0
    ),
    error_sd = 0.5     # Increased measurement error (standardized)
  )
)
}
}
\concept{data-simulation}

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate Joint ODE Model Data — simulate • JointODE</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate Joint ODE Model Data — simulate"><meta name="description" content="Generates synthetic data from a sophisticated joint modeling framework that
seamlessly integrates longitudinal biomarker trajectories with survival
outcomes through ordinary differential equations (ODEs). This simulation
engine produces realistic clinical trial datasets where complex biomarker
dynamics govern event hazards via shared random effects and trajectory
features, capturing the intricate interplay between disease progression
and time-to-event processes."><meta property="og:description" content="Generates synthetic data from a sophisticated joint modeling framework that
seamlessly integrates longitudinal biomarker trajectories with survival
outcomes through ordinary differential equations (ODEs). This simulation
engine produces realistic clinical trial datasets where complex biomarker
dynamics govern event hazards via shared random effects and trajectory
features, capturing the intricate interplay between disease progression
and time-to-event processes."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JointODE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/technical-details.html">Technical Details</a></li>
    <li><a class="dropdown-item" href="../articles/comparison.html">Comparison</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ziyangg98/JointODE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate Joint ODE Model Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/ziyangg98/JointODE/blob/v0.1.0/R/simulate.R" class="external-link"><code>R/simulate.R</code></a></small>
      <div class="d-none name"><code>simulate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates synthetic data from a sophisticated joint modeling framework that
seamlessly integrates longitudinal biomarker trajectories with survival
outcomes through ordinary differential equations (ODEs). This simulation
engine produces realistic clinical trial datasets where complex biomarker
dynamics govern event hazards via shared random effects and trajectory
features, capturing the intricate interplay between disease progression
and time-to-event processes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulate</span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.8</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  phi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="op">-</span><span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  weibull_shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weibull_scale <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  sigma_b <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sigma_e <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Integer. Number of subjects to simulate. Larger cohorts provide
more stable parameter estimates (default: 100).</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Numeric vector of length 3. Association parameters quantifying
how trajectory features influence survival hazard:
<code>[biomarker, velocity, acceleration]</code>.
Positive values indicate increased risk (default: c(0.6, 1.0, -1.5)).</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Numeric vector governing ODE dynamics (length 5). Controls
biomarker trajectory evolution: <code>[biomarker, velocity,
  x1, x2, time]</code> (default: c(-1.0, -0.6, -0.8, 0.5, 0.4)).</p></dd>


<dt id="arg-phi">phi<a class="anchor" aria-label="anchor" href="#arg-phi"></a></dt>
<dd><p>Numeric vector of length 2. Baseline covariate effects modulating
survival hazard independently of biomarker dynamics: <code>[w1, w2]</code>
(default: c(0.8, -1.2)).</p></dd>


<dt id="arg-weibull-shape">weibull_shape<a class="anchor" aria-label="anchor" href="#arg-weibull-shape"></a></dt>
<dd><p>Numeric. Weibull shape parameter (\(\kappa\))
characterizing baseline hazard evolution. Values &gt; 1 yield increasing
hazard (aging effect), &lt; 1 decreasing hazard (selection effect), =
1 constant hazard (exponential) (default: 1).</p></dd>


<dt id="arg-weibull-scale">weibull_scale<a class="anchor" aria-label="anchor" href="#arg-weibull-scale"></a></dt>
<dd><p>Numeric. Weibull scale parameter (\(\theta\))
determining the characteristic event time. Larger values shift the
hazard curve rightward (default: 8).</p></dd>


<dt id="arg-sigma-b">sigma_b<a class="anchor" aria-label="anchor" href="#arg-sigma-b"></a></dt>
<dd><p>Numeric. Standard deviation of subject-specific random effects
capturing unobserved heterogeneity. Larger values increase between-subject
variability in both trajectories and hazards (default: 0.1).</p></dd>


<dt id="arg-sigma-e">sigma_e<a class="anchor" aria-label="anchor" href="#arg-sigma-e"></a></dt>
<dd><p>Numeric. Measurement error standard deviation reflecting
assay precision and biological fluctuations. Smaller values indicate
more reliable biomarker measurements (default: 0.1).</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Integer. Random seed ensuring reproducible simulations.
Essential for method validation and comparison studies (default: 42).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. Display informative progress messages during
simulation workflow (default: FALSE).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing two complementary datasets:</p><dl><dt>longitudinal_data</dt>
<dd><p>Data frame with longitudinal measurements:</p><ul><li><p><code>id</code>: Subject identifier</p></li>
<li><p><code>time</code>: Measurement time</p></li>
<li><p><code>v</code>: Observed biomarker value incorporating latent
trajectory, random effect, and measurement error</p></li>
<li><p><code>x1</code>: First longitudinal covariate (standardized)</p></li>
<li><p><code>x2</code>: Second longitudinal covariate (standardized)</p></li>
<li><p><code>biomarker</code>: True latent biomarker trajectory value</p></li>
<li><p><code>velocity</code>: True latent biomarker velocity value</p></li>
<li><p><code>acceleration</code>: True latent biomarker acceleration value</p></li>
</ul></dd>

<dt>survival_data</dt>
<dd><p>Data frame with survival outcomes:</p><ul><li><p><code>id</code>: Subject identifier</p></li>
<li><p><code>time</code>: Observed event/censoring time</p></li>
<li><p><code>status</code>: Event indicator (1 = event, 0 = censored)</p></li>
<li><p><code>w1</code>: First survival covariate (standardized)</p></li>
<li><p><code>w2</code>: Second survival covariate (standardized)</p></li>
<li><p><code>b</code>: Shared random effect</p></li>
</ul></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Mathematical Framework</strong></p>
<p>The simulation orchestrates a sophisticated joint model architecture
comprising two intricately coupled components:</p>
<p><strong>1. Longitudinal Dynamics</strong></p>
<p>Biomarker evolution is governed by a second-order linear ODE system
that captures temporal dynamics:
$$\ddot{m}_i(t) = \boldsymbol{\beta}^{\top} \mathbf{Z}_i(t)$$</p>
<p>where:</p><ul><li><p>\(m_i(t)\): Latent biomarker trajectory for subject \(i\)</p></li>
<li><p>\(\mathbf{Z}_i(t) = [m_i(t), \dot{m}_i(t), X_1, X_2, t]^{\top}\):
State vector (5-dimensional)</p></li>
<li><p>\(\boldsymbol{\beta}\): Parameter vector governing homeostatic
feedback, damping forces, and external influences</p></li>
</ul><p>Observed measurements arise from a hierarchical structure incorporating
both systematic and stochastic components:
$$V_{ij} = m_i(T_{ij}) + b_i + \varepsilon_{ij}$$</p>
<p>where \(b_i \sim N(0, \sigma_b^2)\) captures subject-specific deviations
and \(\varepsilon_{ij} \sim N(0, \sigma_e^2)\) represents measurement
variability.</p>
<p><strong>2. Survival Process</strong></p>
<p>The instantaneous hazard function elegantly links biomarker dynamics
to event risk through a multiplicative model:
$$\lambda_i(t|b_i) = \lambda_0(t) \exp[\boldsymbol{\alpha}^{\top}
  \mathbf{m}_i(t) + \mathbf{W}_i^{\top} \boldsymbol{\phi} + b_i]$$</p>
<p>where:</p><ul><li><p>\(\lambda_0(t) = (\kappa/\theta)(t/\theta)^{\kappa-1}\):
Weibull baseline hazard capturing population-level risk evolution</p></li>
<li><p>\(\mathbf{m}_i(t) = [m_i(t), \dot{m}_i(t), \ddot{m}_i(t)]^{\top}\):
Comprehensive trajectory feature vector</p></li>
<li><p>\(\mathbf{W}_i\): Time-invariant baseline characteristics</p></li>
<li><p>\(b_i\): Shared random effect inducing correlation between
longitudinal and survival processes</p></li>
</ul><p><strong>Simulation Workflow</strong></p>
<p>The data generation proceeds through a carefully orchestrated pipeline:</p>
<ol><li><p><strong>ODE Integration</strong>: Numerical solution of the coupled ODE
system using adaptive Runge-Kutta methods with automatic step size
control for optimal accuracy-efficiency tradeoff</p></li>
<li><p><strong>Event Time Generation</strong>: Sophisticated sampling from the
conditional hazard distribution via the <code>simsurv</code> engine,
accounting for complex time-varying covariates</p></li>
<li><p><strong>Censoring Mechanism</strong>: Realistic administrative censoring
uniformly distributed between the 50th and 95th percentiles of
event times, mimicking clinical trial follow-up patterns</p></li>
<li><p><strong>Visit Scheduling</strong>: Adaptive measurement protocols with
higher frequency during critical periods (quarterly initially,
semi-annual subsequently) and stochastic 10% missingness</p></li>
</ol><p><strong>Parameter Interpretation Guide</strong></p>
<ul><li><p><strong>Trajectory Dynamics (<code>beta</code>)</strong>:</p><ul><li><p><code>beta[1]</code>: Homeostatic feedback strength (negative values
promote stability)</p></li>
<li><p><code>beta[2]</code>: Damping coefficient controlling oscillation
suppression</p></li>
<li><p><code>beta[3-4]</code>: Sensitivity to longitudinal covariates</p></li>
<li><p><code>beta[5]</code>: Time trend capturing systematic changes</p></li>
</ul></li>
<li><p><strong>Hazard Association (<code>alpha</code>)</strong>:</p><ul><li><p><code>alpha[1]</code>: Current biomarker value effect (positive
indicates deleterious biomarker)</p></li>
<li><p><code>alpha[2]</code>: Velocity effect capturing prognostic value
of trajectory direction</p></li>
<li><p><code>alpha[3]</code>: Acceleration effect reflecting stability
importance (negative suggests protective stability)</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>

<ul><li><p>Visit schedules intelligently adapt to individual follow-up
durations, balancing information gain with practical constraints</p></li>
<li><p>Progress reporting can be silenced via <code>verbose = FALSE</code>
for batch simulations</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/simsurv/man/simsurv.html" class="external-link">simsurv</a></code> for the underlying survival simulation
<code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></code> for ODE integration details</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic usage with default parameters</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">simulate</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ longitudinal_data:'data.frame':	1010 obs. of  8 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ id          : int [1:1010] 1 1 1 1 1 2 2 2 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ time        : num [1:1010] 0 0.25 0.5 0.75 1 0 0.5 0.75 1 1.25 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ v           : num [1:1010] 0.0919 0.1938 0.2904 0.3098 0.2987 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ x1          : num [1:1010] -0.00462 -0.00462 -0.00462 -0.00462 -0.00462 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ x2          : num [1:1010] 1.33 1.33 1.33 1.33 1.33 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ biomarker   : num [1:1010] 0 0.0209 0.0822 0.1806 0.3111 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ velocity    : num [1:1010] 0 0.166 0.322 0.462 0.578 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ acceleration: num [1:1010] 0.671 0.651 0.595 0.514 0.413 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ survival_data    :'data.frame':	100 obs. of  6 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ id    : int [1:100] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ time  : num [1:100] 1.039 4.397 2.937 8.928 0.746 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ status: int [1:100] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ w1    : num [1:100] 1.201 1.045 -1.003 1.848 -0.667 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ w2    : num [1:100] -2.001 0.334 1.171 2.06 -1.377 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ b     : num [1:100] 0.1371 -0.0565 0.0363 0.0633 0.0404 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check data characteristics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Event rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">survival_data</span><span class="op">$</span><span class="va">status</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event rate: 0.77 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Observations per subject:"</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">longitudinal_data</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">survival_data</span><span class="op">)</span>, <span class="st">"\n"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observations per subject: 10.1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualize trajectories with survival information</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select subjects with different outcomes</span></span></span>
<span class="r-in"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">longitudinal_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">survival_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"time"</span>, <span class="st">"status"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    by <span class="op">=</span> <span class="st">"id"</span>, suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"_event"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">v</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">time_event</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">id</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Censored"</span>, <span class="st">"Event"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"Time (years)"</span>, y <span class="op">=</span> <span class="st">"Biomarker Value"</span>, color <span class="op">=</span> <span class="st">"Outcome"</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Simulated Longitudinal Trajectories"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_line()`: Each group consists of only one observation.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Do you need to adjust the <span style="color: #00BB00;">group</span> aesthetic?</span>
<span class="r-plt img"><img src="simulate-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ziyang Gong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

